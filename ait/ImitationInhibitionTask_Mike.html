<!DOCTYPE html>
<html>
	<head>
		<title>My experiment</title>
		<script src = "jspsych-6.1.0/jspsych.js"></script>
		
		<!-- Regular plugins -->
		
		<script src = "jspsych-6.1.0/plugins/jspsych-html-keyboard-response.js"></script>
		<script src = "jspsych-6.1.0/plugins/jspsych-fullscreen.js"></script>
		<script src = "jspsych-6.1.0/plugins/jspsych-call-function.js"></script>
		<script src = "jspsych-6.1.0/plugins/jspsych-audio-keyboard-response.js"></script>
		<script src = "jspsych-6.1.0/plugins/jspsych-image-slider-response.js"></script>
		
		<!-- My plugins -->
		
		<script src = "jspsych-6.1.0/plugins/my_plugins/jspsych-fixation-image-keyboard-release.js"></script>
		<script src = "jspsych-6.1.0/plugins/my_plugins/jspsych-check-response.js"></script>
		
		<!-- CSS -->
		
		<link href = "jspsych-6.1.0/css/jspsych.css" rel="stylesheet" type="text/css"></link>
			
		<style>
			.my_window { width: 80vw; height: auto; max-width: 100%; position: relative;}
			.my_window p { font-family: Arial; font-size: 14pt; line-height: 1.25; }
		</style>
	</head>	
	<body style="background-color:black;color:white;"></body>
	<script>

	/////////////////
	///  GLOBALS  ///
	/////////////////
	
	/* TIMELINE */

	var timeline = [];
	
	/* SUBJECT ID */
	
	var subject_id = jsPsych.randomization.randomID(15);
	
	/* EVENT FUNCTIONS */
	
	var keys_down = [];
	
	function my_keydown(e){
		my_key = jsPsych.pluginAPI.convertKeyCharacterToKeyCode(e.key) || e.keyCode;
		if(keys_down[my_key] != true){ // prevents constant updating (not sure if necessary)
			keys_down[my_key] = true;
		}
	};
	
	function my_keyup(e){
		my_key = jsPsych.pluginAPI.convertKeyCharacterToKeyCode(e.key) || e.keyCode;
		keys_down[my_key] = false;
	};
	
	/* TASK SETTINGS */
	
	var left_key = jsPsych.pluginAPI.convertKeyCharacterToKeyCode('g');
	var right_key = jsPsych.pluginAPI.convertKeyCharacterToKeyCode('h');
		
	/////////////////////
	///  FULL SCREEN  ///
	/////////////////////
		
	var fullscreen_on = {
		type: 'fullscreen',
		fullscreen_mode: true
	};
	
	timeline.push(fullscreen_on);
	
	////////////////////
	///  HIDE MOUSE  ///
	////////////////////
	
	var no_mouse = {
		type: 'call-function',
		func: function(){ 
			document.querySelector('head').insertAdjacentHTML('beforeend', '<style id="cursor-toggle"> html { cursor: none; } </style>'); 
		}
	};
	
	timeline.push(no_mouse);
	
	/////////////////////////////
	///  ADD EVENT LISTENERS  ///
	/////////////////////////////
	
	var add_listeners = {
		type: 'call-function',
		func: function(){ 
			document.addEventListener("keydown", my_keydown, false);
			document.addEventListener("keyup", my_keyup, false);
		}
	};
	
	timeline.push(add_listeners);
		
	//////////////////////
	///  INSTRUCTIONS  ///
	//////////////////////
	
	var instr_welcome = {
		type: 'html-keyboard-response',
		choices: ['enter'],
		stimulus: "<div class = 'my_window'>"+
				  "<p>Welcome in this experiment!</p><br>"+

				  "<p>Your task is to respond to the number. "+
				  "Hold down the G and H keys. If you see the number 1, release the G key by lifting your index finger. "+
				  "If you see the number 2, release the H key by lifting your middle finger. After every key release, a tone will play. "+
				  "Your job is to estimate the interval between your key release and the tone (anywhere between 1ms-1000ms).</p><br>"+

				  "<p>Press ENTER to start the experiment.</p></div>",
		post_trial_gap: 0
	};
	
	timeline.push(instr_welcome);
	
	///////////////////////
	///  RANDOMIZATION  ///
	///////////////////////
	
	var design = [

	//
		{img1: "New Stimuli/A - Fixation.BMP", img2: "New Stimuli/C1-H1-I A.BMP", data: {test: 'exp', finger: 1, cue: 0, con: "C", correct_response: "g"}},
		{img1: "New Stimuli/A - Fixation.BMP", img2: "New Stimuli/C1-H1-I B.BMP", data: {test: 'exp', finger: 1, cue: 0, con: "C", correct_response: "g"}},
		{img1: "New Stimuli/A - Fixation.BMP", img2: "New Stimuli/C1-H1-I C.BMP", data: {test: 'exp', finger: 1, cue: 0, con: "C", correct_response: "g"}},
		{img1: "New Stimuli/A - Fixation.BMP", img2: "New Stimuli/C1-H1-I D.BMP", data: {test: 'exp', finger: 1, cue: 0, con: "C", correct_response: "g"}},

	//
		{img1: "New Stimuli/A - Fixation.BMP", img2: "New Stimuli/C1-H2-I A.BMP", data: {test: 'exp', finger: 1, cue: 0, con: "C", correct_response: "g"}},
		{img1: "New Stimuli/A - Fixation.BMP", img2: "New Stimuli/C1-H2-I B.BMP", data: {test: 'exp', finger: 1, cue: 0, con: "C", correct_response: "g"}},
		{img1: "New Stimuli/A - Fixation.BMP", img2: "New Stimuli/C1-H2-I C.BMP", data: {test: 'exp', finger: 1, cue: 0, con: "C", correct_response: "g"}},
		{img1: "New Stimuli/A - Fixation.BMP", img2: "New Stimuli/C1-H2-I D.BMP", data: {test: 'exp', finger: 1, cue: 0, con: "C", correct_response: "g"}},
		{img1: "New Stimuli/A - Fixation.BMP", img2: "New Stimuli/C1-H2-I E.BMP", data: {test: 'exp', finger: 1, cue: 0, con: "C", correct_response: "g"}},
		{img1: "New Stimuli/A - Fixation.BMP", img2: "New Stimuli/C1-H2-I F.BMP", data: {test: 'exp', finger: 1, cue: 0, con: "C", correct_response: "g"}},


	//
		{img1: "New Stimuli/A - Fixation.BMP", img2: "New Stimuli/C1-H3-I A.BMP", data: {test: 'exp', finger: 1, cue: 0, con: "C", correct_response: "g"}},
		{img1: "New Stimuli/A - Fixation.BMP", img2: "New Stimuli/C1-H3-I B.BMP", data: {test: 'exp', finger: 1, cue: 0, con: "C", correct_response: "g"}},
		{img1: "New Stimuli/A - Fixation.BMP", img2: "New Stimuli/C1-H3-I C.BMP", data: {test: 'exp', finger: 1, cue: 0, con: "C", correct_response: "g"}},
		{img1: "New Stimuli/A - Fixation.BMP", img2: "New Stimuli/C1-H3-I D.BMP", data: {test: 'exp', finger: 1, cue: 0, con: "C", correct_response: "g"}},


	//
		{img1: "New Stimuli/A - Fixation.BMP", img2: "New Stimuli/C1-H4-I A.BMP", data: {test: 'exp', finger: 1, cue: 0, con: "C", correct_response: "g"}},
		{img1: "New Stimuli/A - Fixation.BMP", img2: "New Stimuli/C1-H4-I A.BMP", data: {test: 'exp', finger: 1, cue: 0, con: "C", correct_response: "g"}},
		{img1: "New Stimuli/A - Fixation.BMP", img2: "New Stimuli/C1-H4-I A.BMP", data: {test: 'exp', finger: 1, cue: 0, con: "C", correct_response: "g"}},
		{img1: "New Stimuli/A - Fixation.BMP", img2: "New Stimuli/C1-H4-I A.BMP", data: {test: 'exp', finger: 1, cue: 0, con: "C", correct_response: "g"}},
		{img1: "New Stimuli/A - Fixation.BMP", img2: "New Stimuli/C1-H4-I A.BMP", data: {test: 'exp', finger: 1, cue: 0, con: "C", correct_response: "g"}},
		{img1: "New Stimuli/A - Fixation.BMP", img2: "New Stimuli/C1-H4-I A.BMP", data: {test: 'exp', finger: 1, cue: 0, con: "C", correct_response: "g"}},

	///////////////////////

		{img1: "New Stimuli/A - Fixation.BMP", img2: "New Stimuli/C2-H1-I A.BMP", data: {test: 'exp', finger: 1, cue: 1, con: "IC", correct_response: "g"}},
		{img1: "New Stimuli/A - Fixation.BMP", img2: "New Stimuli/C2-H1-I B.BMP", data: {test: 'exp', finger: 1, cue: 1, con: "IC", correct_response: "g"}},
		{img1: "New Stimuli/A - Fixation.BMP", img2: "New Stimuli/C2-H1-I C.BMP", data: {test: 'exp', finger: 1, cue: 1, con: "IC", correct_response: "g"}},
		{img1: "New Stimuli/A - Fixation.BMP", img2: "New Stimuli/C2-H1-I D.BMP", data: {test: 'exp', finger: 1, cue: 1, con: "IC", correct_response: "g"}},

	//
		{img1: "New Stimuli/A - Fixation.BMP", img2: "New Stimuli/C2-H2-I A.BMP", data: {test: 'exp', finger: 1, cue: 1, con: "IC", correct_response: "g"}},
		{img1: "New Stimuli/A - Fixation.BMP", img2: "New Stimuli/C2-H2-I B.BMP", data: {test: 'exp', finger: 1, cue: 1, con: "IC", correct_response: "g"}},
		{img1: "New Stimuli/A - Fixation.BMP", img2: "New Stimuli/C2-H2-I C.BMP", data: {test: 'exp', finger: 1, cue: 1, con: "IC", correct_response: "g"}},
		{img1: "New Stimuli/A - Fixation.BMP", img2: "New Stimuli/C2-H2-I D.BMP", data: {test: 'exp', finger: 1, cue: 1, con: "IC", correct_response: "g"}},
		{img1: "New Stimuli/A - Fixation.BMP", img2: "New Stimuli/C2-H2-I E.BMP", data: {test: 'exp', finger: 1, cue: 1, con: "IC", correct_response: "g"}},
		{img1: "New Stimuli/A - Fixation.BMP", img2: "New Stimuli/C2-H2-I F.BMP", data: {test: 'exp', finger: 1, cue: 1, con: "IC", correct_response: "g"}},


	//
		{img1: "New Stimuli/A - Fixation.BMP", img2: "New Stimuli/C2-H3-I A.BMP", data: {test: 'exp', finger: 1, cue: 1, con: "IC", correct_response: "g"}},
		{img1: "New Stimuli/A - Fixation.BMP", img2: "New Stimuli/C2-H3-I B.BMP", data: {test: 'exp', finger: 1, cue: 1, con: "IC", correct_response: "g"}},
		{img1: "New Stimuli/A - Fixation.BMP", img2: "New Stimuli/C2-H3-I C.BMP", data: {test: 'exp', finger: 1, cue: 1, con: "IC", correct_response: "g"}},
		{img1: "New Stimuli/A - Fixation.BMP", img2: "New Stimuli/C2-H3-I D.BMP", data: {test: 'exp', finger: 1, cue: 1, con: "IC", correct_response: "g"}},


	//
		{img1: "New Stimuli/A - Fixation.BMP", img2: "New Stimuli/C2-H4-I A.BMP", data: {test: 'exp', finger: 1, cue: 1, con: "IC", correct_response: "g"}},
		{img1: "New Stimuli/A - Fixation.BMP", img2: "New Stimuli/C2-H4-I A.BMP", data: {test: 'exp', finger: 1, cue: 1, con: "IC", correct_response: "g"}},
		{img1: "New Stimuli/A - Fixation.BMP", img2: "New Stimuli/C2-H4-I A.BMP", data: {test: 'exp', finger: 1, cue: 1, con: "IC", correct_response: "g"}},
		{img1: "New Stimuli/A - Fixation.BMP", img2: "New Stimuli/C2-H4-I A.BMP", data: {test: 'exp', finger: 1, cue: 1, con: "IC", correct_response: "g"}},
		{img1: "New Stimuli/A - Fixation.BMP", img2: "New Stimuli/C2-H4-I A.BMP", data: {test: 'exp', finger: 1, cue: 1, con: "IC", correct_response: "g"}},
		{img1: "New Stimuli/A - Fixation.BMP", img2: "New Stimuli/C2-H4-I A.BMP", data: {test: 'exp', finger: 1, cue: 1, con: "IC", correct_response: "g"}},


	/////////////////////////
		{img1: "New Stimuli/A - Fixation.BMP", img2: "New Stimuli/C1-H1-M A.BMP", data: {test: 'exp', finger: 2, cue: 0, con: "IC", correct_response: "h"}},
		{img1: "New Stimuli/A - Fixation.BMP", img2: "New Stimuli/C1-H1-M B.BMP", data: {test: 'exp', finger: 2, cue: 0, con: "IC", correct_response: "h"}},
		{img1: "New Stimuli/A - Fixation.BMP", img2: "New Stimuli/C1-H1-M C.BMP", data: {test: 'exp', finger: 2, cue: 0, con: "IC", correct_response: "h"}},
		{img1: "New Stimuli/A - Fixation.BMP", img2: "New Stimuli/C1-H1-M D.BMP", data: {test: 'exp', finger: 2, cue: 0, con: "IC", correct_response: "h"}},

	//
		{img1: "New Stimuli/A - Fixation.BMP", img2: "New Stimuli/C1-H2-M A.BMP", data: {test: 'exp', finger: 2, cue: 0, con: "IC", correct_response: "h"}},
		{img1: "New Stimuli/A - Fixation.BMP", img2: "New Stimuli/C1-H2-M B.BMP", data: {test: 'exp', finger: 2, cue: 0, con: "IC", correct_response: "h"}},
		{img1: "New Stimuli/A - Fixation.BMP", img2: "New Stimuli/C1-H2-M C.BMP", data: {test: 'exp', finger: 2, cue: 0, con: "IC", correct_response: "h"}},
		{img1: "New Stimuli/A - Fixation.BMP", img2: "New Stimuli/C1-H2-M D.BMP", data: {test: 'exp', finger: 2, cue: 0, con: "IC", correct_response: "h"}},
		{img1: "New Stimuli/A - Fixation.BMP", img2: "New Stimuli/C1-H2-M E.BMP", data: {test: 'exp', finger: 2, cue: 0, con: "IC", correct_response: "h"}},
		{img1: "New Stimuli/A - Fixation.BMP", img2: "New Stimuli/C1-H2-M F.BMP", data: {test: 'exp', finger: 2, cue: 0, con: "IC", correct_response: "h"}},


	//
		{img1: "New Stimuli/A - Fixation.BMP", img2: "New Stimuli/C1-H3-M A.BMP", data: {test: 'exp', finger: 2, cue: 0, con: "IC", correct_response: "h"}},
		{img1: "New Stimuli/A - Fixation.BMP", img2: "New Stimuli/C1-H3-M B.BMP", data: {test: 'exp', finger: 2, cue: 0, con: "IC", correct_response: "h"}},
		{img1: "New Stimuli/A - Fixation.BMP", img2: "New Stimuli/C1-H3-M C.BMP", data: {test: 'exp', finger: 2, cue: 0, con: "IC", correct_response: "h"}},
		{img1: "New Stimuli/A - Fixation.BMP", img2: "New Stimuli/C1-H3-M D.BMP", data: {test: 'exp', finger: 2, cue: 0, con: "IC", correct_response: "h"}},


	//
		{img1: "New Stimuli/A - Fixation.BMP", img2: "New Stimuli/C1-H4-I A.BMP", data: {test: 'exp', finger: 2, cue: 0, con: "IC", correct_response: "h"}},
		{img1: "New Stimuli/A - Fixation.BMP", img2: "New Stimuli/C1-H4-I A.BMP", data: {test: 'exp', finger: 2, cue: 0, con: "IC", correct_response: "h"}},
		{img1: "New Stimuli/A - Fixation.BMP", img2: "New Stimuli/C1-H4-I A.BMP", data: {test: 'exp', finger: 2, cue: 0, con: "IC", correct_response: "h"}},
		{img1: "New Stimuli/A - Fixation.BMP", img2: "New Stimuli/C1-H4-I A.BMP", data: {test: 'exp', finger: 2, cue: 0, con: "IC", correct_response: "h"}},
		{img1: "New Stimuli/A - Fixation.BMP", img2: "New Stimuli/C1-H4-I A.BMP", data: {test: 'exp', finger: 2, cue: 0, con: "IC", correct_response: "h"}},
		{img1: "New Stimuli/A - Fixation.BMP", img2: "New Stimuli/C1-H4-I A.BMP", data: {test: 'exp', finger: 2, cue: 0, con: "IC", correct_response: "h"}},

	/////////////////////////
		{img1: "New Stimuli/A - Fixation.BMP", img2: "New Stimuli/C2-H1-M A.BMP", data: {test: 'exp', finger: 2, cue: 1, con: "C", correct_response: "h"}},
		{img1: "New Stimuli/A - Fixation.BMP", img2: "New Stimuli/C2-H1-M B.BMP", data: {test: 'exp', finger: 2, cue: 1, con: "C", correct_response: "h"}},
		{img1: "New Stimuli/A - Fixation.BMP", img2: "New Stimuli/C2-H1-M C.BMP", data: {test: 'exp', finger: 2, cue: 1, con: "C", correct_response: "h"}},
		{img1: "New Stimuli/A - Fixation.BMP", img2: "New Stimuli/C2-H1-M D.BMP", data: {test: 'exp', finger: 2, cue: 1, con: "C", correct_response: "h"}},

	//
		{img1: "New Stimuli/A - Fixation.BMP", img2: "New Stimuli/C2-H2-M A.BMP", data: {test: 'exp', finger: 2, cue: 1, con: "C", correct_response: "h"}},
		{img1: "New Stimuli/A - Fixation.BMP", img2: "New Stimuli/C2-H2-M B.BMP", data: {test: 'exp', finger: 2, cue: 1, con: "C", correct_response: "h"}},
		{img1: "New Stimuli/A - Fixation.BMP", img2: "New Stimuli/C2-H2-M C.BMP", data: {test: 'exp', finger: 2, cue: 1, con: "C", correct_response: "h"}},
		{img1: "New Stimuli/A - Fixation.BMP", img2: "New Stimuli/C2-H2-M D.BMP", data: {test: 'exp', finger: 2, cue: 1, con: "C", correct_response: "h"}},
		{img1: "New Stimuli/A - Fixation.BMP", img2: "New Stimuli/C2-H2-M E.BMP", data: {test: 'exp', finger: 2, cue: 1, con: "C", correct_response: "h"}},
		{img1: "New Stimuli/A - Fixation.BMP", img2: "New Stimuli/C2-H2-M F.BMP", data: {test: 'exp', finger: 2, cue: 1, con: "C", correct_response: "h"}},


	//
		{img1: "New Stimuli/A - Fixation.BMP", img2: "New Stimuli/C2-H3-M A.BMP", data: {test: 'exp', finger: 2, cue: 1, con: "C", correct_response: "h"}},
		{img1: "New Stimuli/A - Fixation.BMP", img2: "New Stimuli/C2-H3-M B.BMP", data: {test: 'exp', finger: 2, cue: 1, con: "C", correct_response: "h"}},
		{img1: "New Stimuli/A - Fixation.BMP", img2: "New Stimuli/C2-H3-M C.BMP", data: {test: 'exp', finger: 2, cue: 1, con: "C", correct_response: "h"}},
		{img1: "New Stimuli/A - Fixation.BMP", img2: "New Stimuli/C2-H3-M D.BMP", data: {test: 'exp', finger: 2, cue: 1, con: "C", correct_response: "h"}},


	//
		{img1: "New Stimuli/A - Fixation.BMP", img2: "New Stimuli/C2-H4-I A.BMP", data: {test: 'exp', finger: 2, cue: 1, con: "C", correct_response: "h"}},
		{img1: "New Stimuli/A - Fixation.BMP", img2: "New Stimuli/C2-H4-I A.BMP", data: {test: 'exp', finger: 2, cue: 1, con: "C", correct_response: "h"}},
		{img1: "New Stimuli/A - Fixation.BMP", img2: "New Stimuli/C2-H4-I A.BMP", data: {test: 'exp', finger: 2, cue: 1, con: "C", correct_response: "h"}},
		{img1: "New Stimuli/A - Fixation.BMP", img2: "New Stimuli/C2-H4-I A.BMP", data: {test: 'exp', finger: 2, cue: 1, con: "C", correct_response: "h"}},
		{img1: "New Stimuli/A - Fixation.BMP", img2: "New Stimuli/C2-H4-I A.BMP", data: {test: 'exp', finger: 2, cue: 1, con: "C", correct_response: "h"}},
		{img1: "New Stimuli/A - Fixation.BMP", img2: "New Stimuli/C2-H4-I A.BMP", data: {test: 'exp', finger: 2, cue: 1, con: "C", correct_response: "h"}}

	];

	var add_design = {
		type: 'call-function',
		func: function(){ 
			var c1h1i = [{img1: "New Stimuli/A - Fixation.BMP", img2: "New Stimuli/C1-H1-I A.BMP", data: {test: 'exp', finger: 1, cue: 0, con: "C", correct_response: "g"}},
						{img1: "New Stimuli/A - Fixation.BMP", img2: "New Stimuli/C1-H1-I B.BMP", data: {test: 'exp', finger: 1, cue: 0, con: "C", correct_response: "g"}},
						{img1: "New Stimuli/A - Fixation.BMP", img2: "New Stimuli/C1-H1-I C.BMP", data: {test: 'exp', finger: 1, cue: 0, con: "C", correct_response: "g"}},
						{img1: "New Stimuli/A - Fixation.BMP", img2: "New Stimuli/C1-H1-I D.BMP", data: {test: 'exp', finger: 1, cue: 0, con: "C", correct_response: "g"}}]

			var c1h3i = [{img1: "New Stimuli/A - Fixation.BMP", img2: "New Stimuli/C1-H3-I A.BMP", data: {test: 'exp', finger: 1, cue: 0, con: "C", correct_response: "g"}},
						{img1: "New Stimuli/A - Fixation.BMP", img2: "New Stimuli/C1-H3-I B.BMP", data: {test: 'exp', finger: 1, cue: 0, con: "C", correct_response: "g"}},
						{img1: "New Stimuli/A - Fixation.BMP", img2: "New Stimuli/C1-H3-I C.BMP", data: {test: 'exp', finger: 1, cue: 0, con: "C", correct_response: "g"}},
						{img1: "New Stimuli/A - Fixation.BMP", img2: "New Stimuli/C1-H3-I D.BMP", data: {test: 'exp', finger: 1, cue: 0, con: "C", correct_response: "g"}}]

			var c2h1i = [{img1: "New Stimuli/A - Fixation.BMP", img2: "New Stimuli/C2-H1-I A.BMP", data: {test: 'exp', finger: 1, cue: 1, con: "IC", correct_response: "g"}},
						{img1: "New Stimuli/A - Fixation.BMP", img2: "New Stimuli/C2-H1-I B.BMP", data: {test: 'exp', finger: 1, cue: 1, con: "IC", correct_response: "g"}},
						{img1: "New Stimuli/A - Fixation.BMP", img2: "New Stimuli/C2-H1-I C.BMP", data: {test: 'exp', finger: 1, cue: 1, con: "IC", correct_response: "g"}},
						{img1: "New Stimuli/A - Fixation.BMP", img2: "New Stimuli/C2-H1-I D.BMP", data: {test: 'exp', finger: 1, cue: 1, con: "IC", correct_response: "g"}}]

			var c2h3i = [{img1: "New Stimuli/A - Fixation.BMP", img2: "New Stimuli/C2-H3-I A.BMP", data: {test: 'exp', finger: 1, cue: 1, con: "IC", correct_response: "g"}},
						{img1: "New Stimuli/A - Fixation.BMP", img2: "New Stimuli/C2-H3-I B.BMP", data: {test: 'exp', finger: 1, cue: 1, con: "IC", correct_response: "g"}},
						{img1: "New Stimuli/A - Fixation.BMP", img2: "New Stimuli/C2-H3-I C.BMP", data: {test: 'exp', finger: 1, cue: 1, con: "IC", correct_response: "g"}},
						{img1: "New Stimuli/A - Fixation.BMP", img2: "New Stimuli/C2-H3-I D.BMP", data: {test: 'exp', finger: 1, cue: 1, con: "IC", correct_response: "g"}}]

			var c1h1m = [{img1: "New Stimuli/A - Fixation.BMP", img2: "New Stimuli/C1-H1-M A.BMP", data: {test: 'exp', finger: 2, cue: 0, con: "IC", correct_response: "h"}},
						{img1: "New Stimuli/A - Fixation.BMP", img2: "New Stimuli/C1-H1-M B.BMP", data: {test: 'exp', finger: 2, cue: 0, con: "IC", correct_response: "h"}},
						{img1: "New Stimuli/A - Fixation.BMP", img2: "New Stimuli/C1-H1-M C.BMP", data: {test: 'exp', finger: 2, cue: 0, con: "IC", correct_response: "h"}},
						{img1: "New Stimuli/A - Fixation.BMP", img2: "New Stimuli/C1-H1-M D.BMP", data: {test: 'exp', finger: 2, cue: 0, con: "IC", correct_response: "h"}}]

			var c1h3m = [{img1: "New Stimuli/A - Fixation.BMP", img2: "New Stimuli/C1-H3-M A.BMP", data: {test: 'exp', finger: 2, cue: 0, con: "IC", correct_response: "h"}},
						{img1: "New Stimuli/A - Fixation.BMP", img2: "New Stimuli/C1-H3-M B.BMP", data: {test: 'exp', finger: 2, cue: 0, con: "IC", correct_response: "h"}},
						{img1: "New Stimuli/A - Fixation.BMP", img2: "New Stimuli/C1-H3-M C.BMP", data: {test: 'exp', finger: 2, cue: 0, con: "IC", correct_response: "h"}},
						{img1: "New Stimuli/A - Fixation.BMP", img2: "New Stimuli/C1-H3-M D.BMP", data: {test: 'exp', finger: 2, cue: 0, con: "IC", correct_response: "h"}}]

			var c2h1m =[{img1: "New Stimuli/A - Fixation.BMP", img2: "New Stimuli/C2-H1-M A.BMP", data: {test: 'exp', finger: 2, cue: 1, con: "C", correct_response: "h"}},
						{img1: "New Stimuli/A - Fixation.BMP", img2: "New Stimuli/C2-H1-M B.BMP", data: {test: 'exp', finger: 2, cue: 1, con: "C", correct_response: "h"}},
						{img1: "New Stimuli/A - Fixation.BMP", img2: "New Stimuli/C2-H1-M C.BMP", data: {test: 'exp', finger: 2, cue: 1, con: "C", correct_response: "h"}},
						{img1: "New Stimuli/A - Fixation.BMP", img2: "New Stimuli/C2-H1-M D.BMP", data: {test: 'exp', finger: 2, cue: 1, con: "C", correct_response: "h"}}]

			var c2h3m = [{img1: "New Stimuli/A - Fixation.BMP", img2: "New Stimuli/C2-H3-M A.BMP", data: {test: 'exp', finger: 2, cue: 1, con: "C", correct_response: "h"}},
						{img1: "New Stimuli/A - Fixation.BMP", img2: "New Stimuli/C2-H3-M B.BMP", data: {test: 'exp', finger: 2, cue: 1, con: "C", correct_response: "h"}},
						{img1: "New Stimuli/A - Fixation.BMP", img2: "New Stimuli/C2-H3-M C.BMP", data: {test: 'exp', finger: 2, cue: 1, con: "C", correct_response: "h"}},
						{img1: "New Stimuli/A - Fixation.BMP", img2: "New Stimuli/C2-H3-M D.BMP", data: {test: 'exp', finger: 2, cue: 1, con: "C", correct_response: "h"}}]

			var c1h1iFirst = c1h1i[Math.floor(Math.random() * c1h1i.length)]
			var c1h1iSecond = c1h1i[Math.floor(Math.random() * c1h1i.length)]

			var c1h3iFirst = c1h3i[Math.floor(Math.random() * c1h3i.length)]
			var c1h3iSecond = c1h3i[Math.floor(Math.random() * c1h3i.length)]

			var c2h1iFirst = c2h1i[Math.floor(Math.random() * c2h1i.length)]
			var c2h1iSecond = c2h1i[Math.floor(Math.random() * c2h1i.length)]

			var c2h3iFirst = c2h3i[Math.floor(Math.random() * c2h3i.length)]
			var c2h3iSecond = c2h3i[Math.floor(Math.random() * c2h3i.length)]

			var c1h1mFirst = c1h1m[Math.floor(Math.random() * c1h1m.length)]
			var c1h1mSecond = c1h1m[Math.floor(Math.random() * c1h1m.length)]

			var c1h3mFirst = c1h3m[Math.floor(Math.random() * c1h3m.length)]
			var c1h3mSecond = c1h3m[Math.floor(Math.random() * c1h3m.length)]		

			var c2h1mFirst = c2h1m[Math.floor(Math.random() * c2h1m.length)]
			var c2h1mSecond = c2h1m[Math.floor(Math.random() * c2h1m.length)]		

			var c2h3mFirst = c2h3m[Math.floor(Math.random() * c2h3m.length)]
			var c2h3mSecond = c2h3m[Math.floor(Math.random() * c2h3m.length)]						

			design.push(c1h1iFirst, c1h1iSecond, c1h3iFirst, c1h3iSecond, c2h1iFirst, c2h1iSecond, c2h3iFirst, c2h3iSecond, c1h1mFirst, c1h1mSecond, c1h3mFirst, c1h3mSecond, c2h1mFirst, c2h1mSecond, c2h3mFirst, c2h3mSecond)

		}
	};
	
	var remove_design = {
		type: 'call-function',
		func: function(){ 
			
			design.pop()
			design.pop()
			design.pop()
			design.pop()
			design.pop()
			design.pop()
			design.pop()
			design.pop()
			design.pop()
			design.pop()
			design.pop()
			design.pop()
			design.pop()
			design.pop()
			design.pop()
			design.pop()

		}
	};
	
	///////////////////////////////////
	///  IMITATION-INHIBITION TASK  ///
	///////////////////////////////////
	
	/* KEYS HELD DOWN? */
	
	var no_response = {
		type: "check-response",
		stimulus: '<div style="font-size:30px;">HOLD DOWN THE G AND H KEYS</div>',
		trial_duration: 1
	};	

	var loop_no_response = {
		timeline: [no_response],
		loop_function: function(){	
			if(keys_down[left_key] == true && keys_down[right_key] == true){
				return false;
			} else {				
				return true;				
			}
		}
	};
		
	var if_no_response = {
		timeline: [loop_no_response],
		conditional_function: function(){
			if(keys_down[left_key] == true && keys_down[right_key] == true){
				return false;
			} else {
				return true;
			}
		}
	};
	
	/* IMITATION-INHIBITION TRIAL */
	var gapArray = [100, 400, 700]
	var gapz = gapArray[Math.floor(Math.random() * gapArray.length)],
	counter = 0
	counterArray = []
	var imi_inh = {
		type: "fixation-image-keyboard-release",		
		fixation: jsPsych.timelineVariable("img1"),		
		stimulus: jsPsych.timelineVariable("img2"),	
		choices: [left_key, right_key],
		fixation_duration: 500,
		trial_duration: 2000,		
		post_trial_gap: gapz,
		data: jsPsych.timelineVariable("data"),
		stimulus_width: 800,
		on_finish: function(data){
    		data.correct = data.key_press == jsPsych.pluginAPI.convertKeyCharacterToKeyCode(data.correct_response)
    		counter = counter + 1
    		counterArray.push(counter)
    		data.gap = gapz
    		gapz = gapArray[Math.floor(Math.random() * gapArray.length)]
    	}
	};
	
	/* Tone */
	var tone = {
    	type: 'audio-keyboard-response',
    	stimulus: 'https://cors-anywhere.herokuapp.com/https://galangca.github.io/ait/tone.mp3',
    	choices: jsPsych.NO_KEYS,
    	trial_ends_after_audio: true,
    	post_trial_gap: 1000
	}; 

	/* Estimate */
	var estimate = {
    	type: 'image-slider-response',
    	stimulus: 'New Stimuli/black.png',
    	labels: ['1ms', '1000ms'],
    	prompt: "<p>Estimate the interval between your action and the tone.</p>",
  		min: 1,
  		max: 1000,
  		start: 500,
  		step: 1
	};

	/* RUN EXPERIMENT */	

	var mouse = {
		type: 'call-function',
		func: function(){ 
			document.querySelector('head').insertAdjacentHTML('beforeend', '<style id="cursor-toggle"> html { cursor: default; } </style>');
		}
	};
	
	var takeABreak = {
		type: 'html-keyboard-response',
    	stimulus: 'Take a break. Feel free to start again by pressing Enter.',
    	choices: ['enter']
	};

	var breakLoop = {
		timeline: [takeABreak],
		conditional_function: function(){
			if(counterArray.includes(48) | counterArray.includes(96) | counterArray.includes(144)| counterArray.includes(192)){
				counterArray = []
				return true;
			} else {
				return false;
			}
		}
	};
	
	var run_experiment = {
		timeline: [no_mouse, if_no_response, imi_inh, tone, mouse, estimate, breakLoop],
		timeline_variables: design,
		sample: {
			type: 'without-replacement',
			size: 20
		}
	};
	
	timeline.push(add_design)
	timeline.push(run_experiment);
	timeline.push(remove_design)
	
	////////////////////////////////
	///  REMOVE EVENT LISTENERS  ///
	////////////////////////////////
	
	var remove_listeners = {
		type: 'call-function',
		func: function(){ 
			document.removeEventListener("keydown", my_keydown, false);
			document.removeEventListener("keyup", my_keyup, false);
		}
	};
	
	timeline.push(remove_listeners);

	/////////////////
	///  GOODBYE  ///
	/////////////////
		
	var goodbye = {
		type: 'html-keyboard-response',
		choices: ['enter'],
		stimulus: "<div class = 'my_window'>"+
				  "<p>This is the end of the experiment</p><br>"+
				  "<p>Press ENTER to leave fullscreen.</p></div>",
		post_trial_gap: 0
	};
		
	timeline.push(goodbye);
	
	////////////////////
	///  SHOW MOUSE  ///
	////////////////////

	timeline.push(mouse);

	//////////////////////////
	///  CLOSE FULLSCREEN  ///
	//////////////////////////
	
	var fullscreen_off = {
		type: 'fullscreen',
		fullscreen_mode: false
	};
	
	timeline.push(fullscreen_off);

	////////////////////////
	///  RUN EXPERIMENT  ///
	////////////////////////

	jsPsych.init({
		timeline: timeline,
		exclusions: {min_width: 1280, min_height: 700},
		show_preload_progress_bar: true,
		on_finish: function() {
			jsPsych.data.displayData();
			jsPsych.data.get().localSave('csv',subject_id+'.csv');
		}		
	});

	</script>
</html>